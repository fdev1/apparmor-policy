#include <tunables/global>

# prevent all executables not matched by other profiles from
# executing programs in the user's home directory
profile noexec-policy /** {
	#include <noexec-policy.d/capsall>
	#include <abstractions/confidential-deny>

	# Deny execution of code from any writable directories.
	# Only code installed by an administrator should be able
	# to execute.
	deny @{HOME}/** x,
	deny /var/** x,
	deny /tmp/** x,
	deny /run/** x,

	# prevent users and applications from running
	# ksshaskpass. Applications that are allowed to
	# use this should have their own profile
	deny /usr/bin/ksshaskpass x,

	# allow unrestricted access to the rest of the
	# file system.
	/{,**} rwlkmpx,
}
